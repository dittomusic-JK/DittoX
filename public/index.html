<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ditto X 25 - Digital Programme</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Official digital programme for Ditto X 2025 at The O2 Arena, London">
    <meta name="theme-color" content="#00ff99">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Ditto X 25">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- iOS Icons -->
    <link rel="apple-touch-icon" href="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68fb840163eb1687421231f6_ios%20home%20screen.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68fb840163eb1687421231f6_ios%20home%20screen.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68fb8401567be091ffe4065e_Android%20Home%20Screen.png">
    
    <style>
        /* Self-Hosted Brand Fonts */
        
        /* Neusa - Bold (for headings) */
        @font-face {
            font-family: 'Neusa';
            src: url('/fonts/Neusa-Bold.otf') format('opentype');
            font-weight: 700;
            font-style: normal;
            font-display: swap;
        }
        
        /* Neusa - Medium (for regular weight headings) */
        @font-face {
            font-family: 'Neusa';
            src: url('/fonts/Neusa-Medium.otf') format('opentype');
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }
        
        /* Satoshi - Regular (for body text) */
        @font-face {
            font-family: 'Satoshi';
            src: url('/fonts/Satoshi-Regular.woff') format('woff');
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }
        
        /* Satoshi - Medium */
        @font-face {
            font-family: 'Satoshi';
            src: url('/fonts/Satoshi-Medium.woff') format('woff');
            font-weight: 500;
            font-style: normal;
            font-display: swap;
        }
        
        /* Satoshi - Bold */
        @font-face {
            font-family: 'Satoshi';
            src: url('/fonts/Satoshi-Bold.woff') format('woff');
            font-weight: 700;
            font-style: normal;
            font-display: swap;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Satoshi', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
            background-attachment: fixed;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            padding-bottom: 80px; /* Space for fixed navigation */
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #070707;
            min-height: 100vh;
            position: relative;
        }
        
        /* Responsive breakpoints */
        @media (max-width: 768px) {
            .container {
                max-width: 100%;
            }
        }
        
        .page {
            min-height: calc(100vh - 80px);
            overflow-y: auto;
            overflow-x: hidden;
            background: #070707;
            scroll-behavior: smooth;
            padding-bottom: 20px;
        }
        
        .page::-webkit-scrollbar { width: 4px; }
        .page::-webkit-scrollbar-track { background: transparent; }
        .page::-webkit-scrollbar-thumb { 
            background: linear-gradient(180deg, #00ff99, #7e00e9);
            border-radius: 10px;
        }
        
        .nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(7, 7, 7, 0.98);
            backdrop-filter: blur(30px);
            border-top: 1px solid rgba(0, 255, 153, 0.2);
            display: flex;
            justify-content: space-around;
            padding: 8px;
            max-width: 1200px;
            margin: 0 auto;
            z-index: 1000;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
        }
        
        @media (max-width: 768px) {
            .nav {
                max-width: 100%;
            }
        }
        
        .nav-btn {
            background: none;
            border: none;
            color: #626984;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: 'Satoshi', sans-serif;
            font-size: 10px;
            padding: 8px 12px;
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            font-weight: 600;
        }
        
        .nav-btn img {
            opacity: 0.6;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            filter: brightness(0.8);
        }
        
        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
        }
        
        .nav-btn:hover img {
            opacity: 1;
            filter: brightness(1.2);
        }
        
        .nav-btn.active {
            color: #00ff99;
            background: rgba(0, 255, 153, 0.1);
            transform: scale(1.05);
        }
        
        .nav-btn.active img {
            opacity: 1;
            filter: brightness(1.3) drop-shadow(0 0 8px rgba(0, 255, 153, 0.5));
        }
        
        .nav-btn.active::before {
            content: '';
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 3px;
            background: linear-gradient(90deg, #00ff99, #7e00e9);
            border-radius: 10px;
            animation: navGlow 2s ease-in-out infinite;
        }
        
        @keyframes navGlow {
            0%, 100% { opacity: 1; box-shadow: 0 0 10px #00ff99; }
            50% { opacity: 0.6; box-shadow: 0 0 20px #00ff99; }
        }
        
        .badge {
            position: absolute;
            top: 2px;
            right: 8px;
            background: linear-gradient(135deg, #ff7201, #ffba00);
            color: #070707;
            font-family: 'Neusa', sans-serif;
            font-size: 9px;
            font-weight: 700;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(255, 114, 1, 0.5);
            animation: badgePulse 2s ease-in-out infinite;
        }
        
        @keyframes badgePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        h1, h2, h3 {
            font-family: 'Neusa', sans-serif;
            color: white;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        .card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.02) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 153, 0.2);
            border-radius: 16px;
            padding: 20px;
            margin: 12px 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 153, 0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .card::after {
            content: '‚Üí';
            position: absolute;
            bottom: 16px;
            right: 16px;
            font-size: 20px;
            font-weight: 700;
            color: rgba(0, 255, 153, 0.5);
            opacity: 1;
            transition: all 0.3s ease;
        }
        
        .card:hover::after {
            color: rgba(0, 255, 153, 0.9);
            transform: translateX(4px);
        }
        
        .card:hover::before {
            left: 100%;
        }
        
        .card:hover {
            transform: translateY(-4px) scale(1.01);
            border-color: rgba(0, 255, 153, 0.4);
            box-shadow: 0 12px 40px rgba(0, 255, 153, 0.15), 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .card:active {
            transform: translateY(-2px) scale(0.99);
        }
        
        /* Hide arrows for non-clickable cards (map keys, speaker info) */
        .card.no-arrow::after {
            display: none;
        }
        
        .card.no-arrow {
            cursor: default;
        }
        
        .card.no-arrow:hover {
            transform: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn {
            padding: 14px 24px;
            border: none;
            border-radius: 999px;
            font-family: 'Satoshi', sans-serif;
            font-weight: 700;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .btn:active::after {
            width: 300px;
            height: 300px;
        }
        
        .btn-teal {
            background: linear-gradient(135deg, #00ff99, #00cc77);
            color: #070707;
            box-shadow: 0 4px 15px rgba(0, 255, 153, 0.3);
        }
        
        .btn-teal:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 255, 153, 0.4);
            background: linear-gradient(135deg, #00ffaa, #00dd88);
        }
        
        .btn-teal:active {
            transform: translateY(0px);
            box-shadow: 0 4px 15px rgba(0, 255, 153, 0.3);
        }
        
        .btn-purple {
            background: linear-gradient(135deg, #7e00e9, #5a00a3);
            color: white;
            box-shadow: 0 4px 15px rgba(126, 0, 233, 0.3);
        }
        
        .btn-purple:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(126, 0, 233, 0.4);
            background: linear-gradient(135deg, #8e00ff, #6a00b3);
        }
        
        .btn-purple:active {
            transform: translateY(0px);
            box-shadow: 0 4px 15px rgba(126, 0, 233, 0.3);
        }
        
        .btn-orange {
            background: linear-gradient(135deg, #ff7201, #cc5a00);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 114, 1, 0.3);
        }
        
        .btn-orange:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(255, 114, 1, 0.4);
            background: linear-gradient(135deg, #ff8211, #dd6a10);
        }
        
        .btn-orange:active {
            transform: translateY(0px);
            box-shadow: 0 4px 15px rgba(255, 114, 1, 0.3);
        }
        
        .text-white { color: white; }
        .text-grey { color: #9a9fae; }
        .text-pink { color: #ff91cc; }
        .hidden { display: none !important; }
        
        input[type="text"], select {
            width: 100%;
            padding: 14px 18px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(0, 255, 153, 0.2);
            border-radius: 12px;
            color: white;
            font-family: 'Satoshi', sans-serif;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        input[type="text"]:focus, select:focus {
            outline: none;
            border-color: #00ff99;
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 20px rgba(0, 255, 153, 0.2);
        }
        
        select {
            cursor: pointer;
            font-weight: 600;
        }
        
        select option {
            background: #1a1a1a;
            color: white;
            padding: 12px;
        }
        
        .heart {
            font-size: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .heart:hover {
            transform: scale(1.2);
        }
        
        .promo-code {
            font-family: 'Neusa', sans-serif;
            background: linear-gradient(135deg, #00ff99, #00cc77);
            color: #070707;
            font-size: 28px;
            font-weight: 700;
            padding: 16px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 16px;
            letter-spacing: 2px;
            box-shadow: 0 4px 20px rgba(0, 255, 153, 0.3);
        }
        
        .countdown {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin: 24px 0;
        }
        
        .countdown div {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 153, 0.2);
            border-radius: 12px;
            padding: 12px 8px;
            min-width: 60px;
            text-align: center;
        }
        
        .countdown .num {
            font-family: 'Neusa', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: #00ff99;
            margin-bottom: 4px;
            line-height: 1;
        }
        
        .countdown .label {
            font-family: 'Satoshi', sans-serif;
            font-size: 10px;
            color: #9a9fae;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .welcome-message {
            text-align: center;
            padding: 24px;
            background: linear-gradient(135deg, rgba(0, 255, 153, 0.1), rgba(126, 0, 233, 0.1));
            border: 2px solid rgba(0, 255, 153, 0.3);
            border-radius: 16px;
            margin: 24px 0;
        }
        
        .welcome-message h2 {
            font-size: 24px;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #00ff99, #7e00e9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .booth-btn {
            background: linear-gradient(135deg, rgba(255, 114, 1, 0.2), rgba(255, 114, 1, 0.05));
            border: 1px solid rgba(255, 114, 1, 0.4);
            color: white;
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            font-family: 'Neusa', sans-serif;
            font-weight: 700;
            transition: all 0.3s ease;
        }
        
        .booth-btn:hover {
            background: linear-gradient(135deg, rgba(255, 114, 1, 0.3), rgba(255, 114, 1, 0.1));
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(255, 114, 1, 0.3);
        }
        
        .partner-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.02));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 153, 0.2);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .partner-card:hover {
            transform: translateY(-4px);
            border-color: rgba(0, 255, 153, 0.4);
            box-shadow: 0 8px 25px rgba(0, 255, 153, 0.2);
        }
        
        .partner-logo {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Neusa', sans-serif;
            font-weight: 700;
            font-size: 18px;
            color: #00ff99;
        }

        .speaker-img, .sponsor-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 16px;
        }

        .stage-badge {
            display: inline-block;
            padding: 6px 12px;
            background: linear-gradient(135deg, rgba(126, 0, 233, 0.3), rgba(126, 0, 233, 0.1));
            border: 1px solid rgba(126, 0, 233, 0.4);
            border-radius: 8px;
            font-family: 'Satoshi', sans-serif;
            font-size: 11px;
            font-weight: 700;
            color: #00ff99;
            margin-bottom: 8px;
        }

        .time-badge {
            display: inline-block;
            padding: 4px 10px;
            background: rgba(0, 255, 153, 0.15);
            border-radius: 6px;
            font-family: 'Satoshi', sans-serif;
            font-size: 12px;
            font-weight: 700;
            color: #00ff99;
        }

        .map-area {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .map-area:hover {
            filter: brightness(1.3);
            transform: scale(1.02);
        }

        .map-area:active {
            filter: brightness(1.5);
            transform: scale(0.98);
        }

        .map-area-hover {
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
        }

        .map-area-hover:hover {
            opacity: 1 !important;
        }

        .floor-map {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #9a9fae;
            font-family: 'Satoshi', sans-serif;
            font-weight: 600;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 24px;
            min-height: 300px;
        }
        
        .loading-icon {
            width: 80px;
            height: 80px;
            animation: spinGlitch 2s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            filter: drop-shadow(0 0 20px rgba(0, 255, 153, 0.4));
        }
        
        .loading-text {
            font-size: 18px;
            font-weight: 700;
            color: #00ff99;
            text-transform: uppercase;
            letter-spacing: 1px;
            animation: pulse 2s ease-in-out infinite;
        }
        
        .loading-subtext {
            font-size: 13px;
            color: #9a9fae;
            font-weight: 500;
        }

        @keyframes spinGlitch {
            0% { 
                transform: rotate(0deg) scale(1);
                filter: drop-shadow(0 0 20px rgba(0, 255, 153, 0.4));
            }
            25% { 
                transform: rotate(90deg) scale(1.1);
                filter: drop-shadow(0 0 30px rgba(0, 255, 153, 0.6));
            }
            50% { 
                transform: rotate(180deg) scale(1) translateX(3px);
                filter: drop-shadow(0 0 20px rgba(126, 0, 233, 0.4));
            }
            75% { 
                transform: rotate(270deg) scale(1.1) translateX(-3px);
                filter: drop-shadow(0 0 30px rgba(0, 255, 153, 0.6));
            }
            100% { 
                transform: rotate(360deg) scale(1);
                filter: drop-shadow(0 0 20px rgba(0, 255, 153, 0.4));
            }
        }
        
        @keyframes pulse {
            0%, 100% { 
                opacity: 1;
                transform: scale(1);
            }
            50% { 
                opacity: 0.7;
                transform: scale(0.98);
            }
        }

        .error {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid rgba(255, 0, 0, 0.3);
            padding: 16px;
            border-radius: 12px;
            color: #ff6b6b;
            font-family: 'Satoshi', sans-serif;
            font-weight: 600;
            margin: 12px 0;
        }
        
        /* PWA & Offline Status Styles */
        .pwa-status {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0, 255, 153, 0.95);
            backdrop-filter: blur(10px);
            color: #070707;
            padding: 8px 16px;
            text-align: center;
            font-size: 13px;
            font-weight: 600;
            z-index: 9999;
            transform: translateY(-100%);
            transition: transform 0.3s ease;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .pwa-status.show {
            transform: translateY(0);
        }
        
        .pwa-status.offline {
            background: rgba(255, 114, 1, 0.95);
            color: white;
        }
        
        .pwa-status.updating {
            background: rgba(26, 75, 255, 0.95);
            color: white;
        }
        
        .install-prompt {
            position: fixed;
            bottom: 90px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #00ff99, #7e00e9);
            color: #070707;
            padding: 16px 24px;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 255, 153, 0.4);
            z-index: 9998;
            max-width: 90%;
            width: 400px;
            display: none;
            animation: slideUp 0.3s ease;
        }
        
        .install-prompt.show {
            display: block;
        }
        
        .install-prompt-content {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .install-prompt-icon {
            font-size: 32px;
        }
        
        .install-prompt-text h3 {
            font-size: 16px;
            margin-bottom: 4px;
            color: #070707;
        }
        
        .install-prompt-text p {
            font-size: 13px;
            opacity: 0.8;
            color: #070707;
        }
        
        .install-prompt-buttons {
            display: flex;
            gap: 8px;
        }
        
        .install-btn {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .install-btn-primary {
            background: #070707;
            color: white;
        }
        
        .install-btn-primary:hover {
            background: #1a1a1a;
            transform: translateY(-1px);
        }
        
        .install-btn-secondary {
            background: rgba(255, 255, 255, 0.3);
            color: #070707;
        }
        
        .install-btn-secondary:hover {
            background: rgba(255, 255, 255, 0.5);
        }
        
        @keyframes slideUp {
            from {
                transform: translateX(-50%) translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <!-- PWA Status Indicators -->
    <div id="pwaStatus" class="pwa-status"></div>
    
    <!-- Install Prompt -->
    <div id="installPrompt" class="install-prompt">
        <div class="install-prompt-content">
            <div class="install-prompt-icon">üì±</div>
            <div class="install-prompt-text">
                <h3>Install Ditto X 25 App</h3>
                <p>Quick access + works offline</p>
            </div>
        </div>
        <div class="install-prompt-buttons">
            <button class="install-btn install-btn-primary" onclick="acceptInstall()">Install</button>
            <button class="install-btn install-btn-secondary" onclick="dismissInstall()">Later</button>
        </div>
    </div>
    
    <div class="container">
        <div class="page" id="content">
            <div class="loading">
                <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/655e0fa544c67c1ee5ce040f_dittoxicon-white.svg" 
                     class="loading-icon" 
                     alt="Loading">
                <div class="loading-text" id="loadingText">Connecting to the vibe</div>
                <div class="loading-subtext">Hang tight...</div>
            </div>
        </div>
        
        <div class="nav">
            <button class="nav-btn active" data-page="welcome" onclick="show('welcome')">
                <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68fb7fe2c713ccd9ee11fdcc_home_DX.svg" 
                     alt="Home" style="width: 24px; height: 24px; margin-bottom: 4px;">
                Home
            </button>
            <button class="nav-btn" data-page="schedule" onclick="show('schedule')">
                <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68fb7fe2a1ffd936855f4f04_schedule_DX.svg" 
                     alt="Schedule" style="width: 24px; height: 24px; margin-bottom: 4px;">
                Schedule
            </button>
            <button class="nav-btn" data-page="agenda" onclick="show('agenda')">
                <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68fb7fe26572868589be04a6_Agenda_DX.svg" 
                     alt="Agenda" style="width: 24px; height: 24px; margin-bottom: 4px;">
                <span id="badge" class="badge hidden">0</span>
                Agenda
            </button>
            <button class="nav-btn" data-page="map" onclick="show('map')">
                <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68fb7fe2beea8175785e1af0_Map_DX.svg" 
                     alt="Map" style="width: 24px; height: 24px; margin-bottom: 4px;">
                Map
            </button>
            <button class="nav-btn" data-page="extras" onclick="show('extras')">
                <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68fb7fe24ce680144a604a8d_Extras_DX.svg" 
                     alt="Extras" style="width: 24px; height: 24px; margin-bottom: 4px;">
                Extras
            </button>
        </div>
    </div>
    
    <script>
        // API Configuration
        const API_BASE = '/api';

        // Data storage
        let webflowData = {
            speakers: [],
            schedule: [],
            sponsors: [],
            stages: [],
            exhibitors: []
        };

        let fav = new Set();
        let currentSession = null;
        
        // Fun loading messages
        const loadingMessages = [
            'Connecting to the vibe',
            'Sorting your schedule',
            'Tuning the frequencies',
            'Loading the lineup',
            'Preparing the stage',
            'Syncing the beats',
            'Warming up the speakers',
            'Checking the setlist',
            'Dialing in the mix',
            'Building the hype'
        ];
        
        let loadingMessageIndex = 0;
        let loadingInterval = null;
        
        // Rotate through loading messages
        function startLoadingMessages() {
            const loadingTextEl = document.getElementById('loadingText');
            if (!loadingTextEl) return;
            
            loadingInterval = setInterval(() => {
                loadingMessageIndex = (loadingMessageIndex + 1) % loadingMessages.length;
                loadingTextEl.textContent = loadingMessages[loadingMessageIndex];
            }, 2000); // Change message every 2 seconds
        }
        
        function stopLoadingMessages() {
            if (loadingInterval) {
                clearInterval(loadingInterval);
                loadingInterval = null;
            }
        }
        
        // Helper function to create loading HTML
        function createLoadingHTML(message = 'Loading the magic') {
            return `
                <div class="loading">
                    <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/655e0fa544c67c1ee5ce040f_dittoxicon-white.svg" 
                         class="loading-icon" 
                         alt="Loading">
                    <div class="loading-text">${message}</div>
                    <div class="loading-subtext">Hold tight...</div>
                </div>
            `;
        }

        // LocalStorage key for saved agenda
        const STORAGE_KEY = 'dittox2025_saved_agenda';

        // Load saved favorites from localStorage
        function loadFavorites() {
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) {
                    const favArray = JSON.parse(saved);
                    fav = new Set(favArray);
                    console.log(`‚úì Loaded ${fav.size} saved sessions from previous visit`);
                }
            } catch (error) {
                console.error('Error loading favorites:', error);
            }
        }

        // Save favorites to localStorage
        function saveFavorites() {
            try {
                const favArray = Array.from(fav);
                localStorage.setItem(STORAGE_KEY, JSON.stringify(favArray));
            } catch (error) {
                console.error('Error saving favorites:', error);
            }
        }

        // Fetch Webflow data via proxy
        async function fetchWebflowData() {
            try {
                console.log('Fetching data from proxy server...');
                
                const response = await fetch(`${API_BASE}/all-data`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                webflowData.speakers = data.speakers || [];
                webflowData.schedule = data.schedule || [];
                webflowData.sponsors = data.sponsors || [];
                webflowData.stages = data.stages || [];
                webflowData.exhibitors = data.exhibitors || [];

                console.log('Webflow data loaded:', webflowData);
                console.log(`‚úì ${webflowData.speakers.length} speakers`);
                console.log(`‚úì ${webflowData.schedule.length} schedule items`);
                console.log(`‚úì ${webflowData.sponsors.length} sponsors`);
                console.log(`‚úì ${webflowData.stages.length} stages`);
                console.log(`‚úì ${webflowData.exhibitors.length} exhibitors`);
                
                return true;
            } catch (error) {
                console.error('Error fetching Webflow data:', error);
                return false;
            }
        }

        // Helper function to get image URL from Webflow
        function getImageUrl(item, fieldName = 'image') {
            const imageField = item.fieldData?.[fieldName];
            if (!imageField) return null;
            
            if (typeof imageField === 'string') return imageField;
            if (imageField.url) return imageField.url;
            if (imageField.fileId) {
                // Use the correct Webflow CDN URL format
                return `https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01c7/${imageField.fileId}/${imageField.fileName || 'image.jpg'}`;
            }
            return null;
        }

        // Helper function to get formatted type name (handles IDs vs names)
        function getTypeName(session) {
            // Try to get type name from various possible fields
            const type = session.typeName || session.fieldData?.typeName || session.fieldData?.typ || session.fieldData?.type;
            if (!type) return null;
            
            // If it looks like an ID (long hex string), return null to skip it
            if (typeof type === 'string' && type.length > 20 && /^[a-f0-9]+$/.test(type)) {
                return null;
            }
            
            return type;
        }

        // Format time from various possible formats
        function formatTime(timeString) {
            if (!timeString) return '';
            try {
                const date = new Date(timeString);
                const hours = date.getHours();
                const minutes = date.getMinutes();
                const ampm = hours >= 12 ? 'PM' : 'AM';
                const displayHours = hours % 12 || 12;
                const displayMinutes = minutes.toString().padStart(2, '0');
                return `${displayHours}:${displayMinutes} ${ampm}`;
            } catch {
                return timeString;
            }
        }

        // Get timestamp from time string for sorting
        function getTimeStamp(timeString) {
            if (!timeString) return 0;
            try {
                return new Date(timeString).getTime();
            } catch {
                return 0;
            }
        }

        // Sort schedule chronologically (earliest first)
        function getSortedSchedule() {
            return [...webflowData.schedule].sort((a, b) => {
                const timeA = getTimeStamp(a.fieldData?.time);
                const timeB = getTimeStamp(b.fieldData?.time);
                return timeA - timeB;
            });
        }

        // Get upcoming sessions (next 3 sessions that haven't started yet)
        function getUpcomingSessions() {
            const now = new Date().getTime();
            const sorted = getSortedSchedule();
            
            // Find sessions that haven't started yet or are happening now (within 2 hours)
            const upcoming = sorted.filter(session => {
                const sessionTime = getTimeStamp(session.fieldData?.time);
                // Show if session is in the future or started within the last 2 hours
                return sessionTime > (now - 2 * 60 * 60 * 1000);
            });
            
            return upcoming.slice(0, 3);
        }

        // Get speaker details from IDs
        function getSpeakerDetails(speakerIds) {
            if (!speakerIds || !Array.isArray(speakerIds)) return [];
            return speakerIds
                .map(id => webflowData.speakers.find(s => s.id === id))
                .filter(s => s);
        }

        // Show session detail page
        function showSessionDetail(sessionId) {
            const session = webflowData.schedule.find(s => s.id === sessionId);
            if (!session) return;
            
            currentSession = session;
            const content = document.getElementById('content');
            content.style.opacity = '0';
            
            setTimeout(() => {
                const speakers = getSpeakerDetails(session.fieldData?.['speakers-2']);
                
                content.innerHTML = `
                    <div style="background: linear-gradient(180deg, #070707 0%, #1a0033 100%); padding: 20px; position: relative;">
                        <button onclick="show('schedule')" class="btn btn-teal" style="margin-bottom: 16px; padding: 10px 20px;">
                            <span style="position: relative; z-index: 1;">‚Üê Back to Schedule</span>
                        </button>
                        
                        ${getImageUrl(session) ? `
                            <img src="${getImageUrl(session)}" 
                                 style="width: 100%; height: 250px; object-fit: cover; border-radius: 16px; margin-bottom: 20px;"
                                 alt="${session.fieldData?.name || 'Session'}">
                        ` : ''}
                        
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px; flex-wrap: wrap;">
                            ${session.fieldData?.time ? `
                                <div class="time-badge">${formatTime(session.fieldData.time)}</div>
                            ` : ''}
                            <div class="stage-badge">${session.stageName || session.fieldData?.stage || 'Main Stage'}</div>
                        </div>
                        
                        <h1 style="font-size: 28px; margin-bottom: 16px; line-height: 1.2;">
                            ${session.fieldData?.name || 'Session'}
                        </h1>
                        
                        ${session.fieldData?.info || session.fieldData?.['info-2'] ? `
                            <p class="text-grey" style="font-size: 15px; line-height: 1.8; margin-bottom: 24px;">
                                ${session.fieldData.info || session.fieldData['info-2']}
                            </p>
                        ` : ''}
                        
                        <button class="heart" onclick="toggle('${session.id}'); showSessionDetail('${session.id}');" 
                                style="background: none; border: none; font-size: 20px; margin-bottom: 24px; cursor: pointer; color: white; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                            ${fav.has(session.id) ? '‚ù§Ô∏è' : 'ü§ç'} <span style="font-size: 16px;">${fav.has(session.id) ? 'Saved to Agenda' : 'Save to Agenda'}</span>
                        </button>
                        
                        ${speakers.length > 0 ? `
                            <h2 style="font-size: 24px; margin-bottom: 16px; color: white; font-family: 'Neusa', sans-serif;">Speakers</h2>
                            <div style="display: grid; gap: 16px;">
                                ${speakers.map(speaker => `
                                    <div class="card no-arrow" style="cursor: default;">
                                        <div style="display: flex; gap: 16px; align-items: start;">
                                            ${getImageUrl(speaker, 'profile-pic') ? `
                                                <img src="${getImageUrl(speaker, 'profile-pic')}" 
                                                     style="width: 100px; height: 100px; border-radius: 12px; object-fit: cover;"
                                                     alt="${speaker.fieldData?.name || 'Speaker'}">
                                            ` : `
                                                <div style="width: 100px; height: 100px; border-radius: 12px; background: linear-gradient(135deg, #00ff99, #7e00e9); display: flex; align-items: center; justify-content: center; font-size: 40px; font-weight: 700; color: #070707; font-family: 'Neusa', sans-serif;">
                                                    ${(speaker.fieldData?.name || '?').charAt(0).toUpperCase()}
                                                </div>
                                            `}
                                            <div style="flex: 1;">
                                                <h3 style="font-size: 24px; margin-bottom: 4px; color: white;">
                                                    ${speaker.fieldData?.name || 'Speaker'}
                                                </h3>
                                                ${speaker.fieldData?.['job-title'] ? `
                                                    <p class="text-grey" style="font-size: 14px; font-weight: 600; margin-bottom: 8px;">
                                                        ${speaker.fieldData['job-title']}
                                                    </p>
                                                ` : ''}
                                                ${getImageUrl(speaker, 'company-logo') ? `
                                                    <img src="${getImageUrl(speaker, 'company-logo')}" 
                                                         style="max-height: 30px; max-width: 150px; width: auto; height: auto; object-fit: contain; margin-bottom: 12px;"
                                                         alt="Company Logo">
                                                ` : ''}
                                                ${speaker.fieldData?.['bio-2'] ? `
                                                    <p class="text-grey" style="font-size: 13px; line-height: 1.6; margin-bottom: 12px;">
                                                        ${speaker.fieldData['bio-2'].length > 300 ? speaker.fieldData['bio-2'].substring(0, 300) + '...' : speaker.fieldData['bio-2']}
                                                    </p>
                                                ` : ''}
                                                ${speaker.fieldData?.linkedin ? `
                                                    <a href="${speaker.fieldData.linkedin}" target="_blank" 
                                                       style="display: inline-flex; align-items: center; gap: 8px; padding: 8px 16px; 
                                                              background: rgba(0, 119, 181, 0.2); border: 1px solid rgba(0, 119, 181, 0.4); 
                                                              border-radius: 8px; color: #0077b5; text-decoration: none; font-weight: 600; 
                                                              font-size: 13px; transition: all 0.3s ease;">
                                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                                                        </svg>
                                                        LinkedIn
                                                    </a>
                                                ` : ''}
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
                
                content.style.opacity = '1';
                content.style.transition = 'opacity 0.3s ease';
            }, 150);
        }

        // Generate pages with Webflow data
        const pages = {
            welcome: () => `
                <div style="background: linear-gradient(180deg, #070707 0%, #1a0033 100%); padding: 40px 24px 24px; 
                     text-align: center; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: -100px; left: -100px; width: 300px; height: 300px; 
                         background: radial-gradient(circle, rgba(0, 255, 153, 0.15), transparent); 
                         filter: blur(60px); animation: pulse 4s ease-in-out infinite;"></div>
                    <div style="position: absolute; bottom: -100px; right: -100px; width: 300px; height: 300px; 
                         background: radial-gradient(circle, rgba(126, 0, 233, 0.15), transparent); 
                         filter: blur(60px); animation: pulse 4s ease-in-out infinite; animation-delay: 2s;"></div>
                    
                    <div style="position: relative; z-index: 1;">
                        <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/686d28fafe0808d727655463_MTMI25_Stacked.webp" 
                             alt="Ditto X 2025 - More Than Music" 
                             style="max-width: 280px; width: 100%; height: auto; margin-bottom: 20px;">
                        <p class="text-grey" style="font-size: 14px; font-weight: 600; margin-bottom: 4px;">
                            Thursday 20th November ‚Ä¢ Indigo at The O2
                        </p>
                    </div>
                </div>
                
                <style>
                    @keyframes pulse {
                        0%, 100% { transform: scale(1); opacity: 0.15; }
                        50% { transform: scale(1.2); opacity: 0.25; }
                    }
                </style>
                
                <!-- Competitions CTA block (replaces countdown) -->
                <div style="padding: 20px;">
                    <div style="background: linear-gradient(135deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); border: 1px solid rgba(0,255,153,0.2); border-radius: 16px; overflow: hidden;">
                        <img src="/solo-studio-lead-2400-2400__13972.webp" alt="Focusrite Studio Bundle" style="width: 100%; height: auto; display: block; max-height: 260px; object-fit: cover; background:#000;">
                        <div style="padding: 16px;">
                            <h2 style="font-size: 22px; margin-bottom: 8px; color: white; font-family: 'Neusa', sans-serif;">Competitions</h2>
                            <p class="text-grey" style="font-size: 14px; margin-bottom: 12px;">Two chances to win today ‚Äî good luck!</p>
                            <div style="display: grid; grid-template-columns: 1fr; gap: 10px;">
                                <button class="btn btn-orange" onclick="showSection('extras','cash-competition')" style="width: 100%;">
                                    <span style="position: relative; z-index: 1;">ü§ë Win ¬£250 cash!</span>
                                </button>
                                <button class="btn btn-purple" onclick="showSection('extras','focusrite')" style="width: 100%;">
                                    <span style="position: relative; z-index: 1;">üé§ Win a Focusrite Production Bundle</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="padding: 0 20px 20px;">
                    ${webflowData.schedule.length > 0 ? `
                        <h2 style="font-size: 24px; margin-bottom: 16px; padding: 0 4px;">Up Next</h2>
                        ${getUpcomingSessions().map(session => `
                            <div class="card" onclick="showSessionDetail('${session.id}')">
                                ${getImageUrl(session) ? `
                                    <img src="${getImageUrl(session)}" class="speaker-img" alt="${session.fieldData?.name || 'Session'}">
                                ` : ''}
                                <div class="stage-badge">${session.stageName || session.fieldData?.stage || 'Main Stage'}</div>
                                <h3 style="font-size: 18px; margin-bottom: 8px; color: white;">${session.fieldData?.name || session.fieldData?.title || 'Session'}</h3>
                                ${session.speakerNames ? `
                                    <p class="text-grey" style="font-size: 14px; font-weight: 600; margin-bottom: 8px;">
                                        ${session.speakerNames}
                                    </p>
                                ` : ''}
                                ${session.fieldData?.time ? `
                                    <span class="time-badge">${formatTime(session.fieldData.time)}</span>
                                ` : ''}
                                ${session.fieldData?.info || session.fieldData?.['info-2'] ? `
                                    <p class="text-grey" style="font-size: 13px; margin-top: 12px; line-height: 1.6;">
                                        ${(session.fieldData.info || session.fieldData['info-2']).substring(0, 120)}...
                                    </p>
                                ` : ''}
                            </div>
                        `).join('')}
                    ` : `
                        ${createLoadingHTML('Sorting your schedule')}
                    `}
                    
                    <button class="btn btn-teal" style="width: 100%; margin-top: 16px;" onclick="show('schedule')">
                        <span style="position: relative; z-index: 1;">VIEW FULL SCHEDULE ‚Üí</span>
                    </button>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 16px;">
                        <button class="btn btn-purple" onclick="show('map')" style="position: relative;">
                            <span style="position: relative; z-index: 1;">üó∫Ô∏è Venue Map</span>
                        </button>
                        <button class="btn btn-orange" onclick="show('extras')" style="position: relative;">
                            <span style="position: relative; z-index: 1;">üéÅ Win ¬£250</span>
                        </button>
                    </div>
                </div>
            `,
            
            schedule: () => `
                <div style="padding: 20px; background: rgba(7, 7, 7, 0.95); backdrop-filter: blur(20px); 
                     border-bottom: 1px solid rgba(0, 255, 153, 0.2); position: sticky; top: 0; z-index: 10;">
                    <h1 style="font-size: 32px; margin-bottom: 16px;">Schedule</h1>
                    <input type="text" placeholder="üîç Search sessions..." id="searchInput" 
                           onkeyup="filterSchedule()" style="margin-bottom: 12px;">
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        <select id="stageFilter" onchange="filterSchedule()" 
                                style="width: 100%; padding: 14px 16px; background: rgba(255, 255, 255, 0.05); 
                                       border: 1px solid rgba(0, 255, 153, 0.2); border-radius: 12px; color: white; 
                                       font-family: 'Satoshi', sans-serif; font-size: 14px; font-weight: 600; cursor: pointer;">
                            <option value="">All Stages</option>
                            ${[...new Set(webflowData.schedule.map(s => s.stageName || s.fieldData?.stage).filter(s => s))].map(stage => 
                                `<option value="${stage}">${stage}</option>`
                            ).join('')}
                        </select>
                        
                        <select id="typeFilter" onchange="filterSchedule()" 
                                style="width: 100%; padding: 14px 16px; background: rgba(255, 255, 255, 0.05); 
                                       border: 1px solid rgba(0, 255, 153, 0.2); border-radius: 12px; color: white; 
                                       font-family: 'Satoshi', sans-serif; font-size: 14px; font-weight: 600; cursor: pointer;">
                            <option value="">All Types</option>
                            ${[...new Set(webflowData.schedule.map(s => getTypeName(s)).filter(t => t))].map(type => 
                                `<option value="${type}">${type}</option>`
                            ).join('')}
                        </select>
                    </div>
                </div>
                
                <div style="padding: 20px;" id="scheduleList">
                    ${webflowData.schedule.length > 0 ? 
                        getSortedSchedule().map(session => `
                            <div class="card schedule-item" 
                                 data-name="${(session.fieldData?.name || session.fieldData?.title || '').toLowerCase()}"
                                 data-stage="${session.stageName || session.fieldData?.stage || ''}"
                                 data-type="${getTypeName(session) || ''}"
                                 onclick="showSessionDetail('${session.id}')">
                                <div style="display: flex; gap: 16px;">
                                    <div style="flex: 1;">
                                        ${getImageUrl(session) ? `
                                            <img src="${getImageUrl(session)}" class="speaker-img" alt="${session.fieldData?.name || 'Session'}" 
                                                 style="height: 120px; margin-bottom: 12px;">
                                        ` : ''}
                                        <div class="stage-badge">${session.stageName || session.fieldData?.stage || 'Main Stage'}</div>
                                        <h3 style="font-size: 18px; margin: 8px 0; color: white;">
                                            ${session.fieldData?.name || session.fieldData?.title || 'Session'}
                                        </h3>
                                        ${session.speakerNames ? `
                                            <p class="text-grey" style="font-size: 14px; font-weight: 600; margin-bottom: 8px;">
                                                üé§ ${session.speakerNames}
                                            </p>
                                        ` : ''}
                                        ${session.fieldData?.time ? `
                                            <span class="time-badge">${formatTime(session.fieldData.time)}</span>
                                        ` : ''}
                                        ${session.fieldData?.info || session.fieldData?.['info-2'] ? `
                                            <p class="text-grey" style="font-size: 13px; margin-top: 12px; line-height: 1.6;">
                                                ${(session.fieldData.info || session.fieldData['info-2']).substring(0, 100)}...
                                            </p>
                                        ` : ''}
                                    </div>
                                    <button class="heart" onclick="event.stopPropagation(); toggle('${session.id}')" style="background: none; border: none; font-size: 24px;">
                                        ${fav.has(session.id) ? '‚ù§Ô∏è' : 'ü§ç'}
                                    </button>
                                </div>
                            </div>
                        `).join('') 
                        : `
                        <div class="card">
                            <div style="text-align: center; padding: 30px;">
                                <div style="font-size: 56px; margin-bottom: 16px;">üìÖ</div>
                                <h3 style="font-size: 20px; margin-bottom: 12px; color: white;">No Schedule Yet</h3>
                                <p class="text-grey" style="font-weight: 500;">
                                    Check back soon for the full event schedule
                                </p>
                            </div>
                        </div>
                    `}
                </div>
            `,
            
            agenda: () => {
                const savedSessions = getSortedSchedule().filter(s => fav.has(s.id));
                return `
                    <div style="padding: 20px; background: rgba(7, 7, 7, 0.95); backdrop-filter: blur(20px); 
                         border-bottom: 1px solid rgba(0, 255, 153, 0.2);">
                        <h1 style="font-size: 32px; margin-bottom: 8px;">My Agenda</h1>
                        <p class="text-grey" style="font-weight: 500; font-size: 14px;">
                            ${savedSessions.length} saved session${savedSessions.length !== 1 ? 's' : ''}
                        </p>
                    </div>
                    
                    <div style="padding: 20px;">
                        ${savedSessions.length > 0 ? 
                            savedSessions.map(session => `
                                <div class="card" onclick="showSessionDetail('${session.id}')">
                                    <div style="display: flex; gap: 16px;">
                                        <div style="flex: 1;">
                                            ${getImageUrl(session) ? `
                                                <img src="${getImageUrl(session)}" class="speaker-img" alt="${session.fieldData?.name || 'Session'}" 
                                                     style="height: 120px; margin-bottom: 12px;">
                                            ` : ''}
                                            <div class="stage-badge">${session.stageName || session.fieldData?.stage || 'Main Stage'}</div>
                                            <h3 style="font-size: 18px; margin: 8px 0; color: white;">
                                                ${session.fieldData?.name || session.fieldData?.title || 'Session'}
                                            </h3>
                                            ${session.speakerNames ? `
                                                <p class="text-grey" style="font-size: 14px; font-weight: 600; margin-bottom: 8px;">
                                                    üé§ ${session.speakerNames}
                                                </p>
                                            ` : ''}
                                            ${session.fieldData?.time ? `
                                                <span class="time-badge">${formatTime(session.fieldData.time)}</span>
                                            ` : ''}
                                            ${session.fieldData?.info || session.fieldData?.['info-2'] ? `
                                                <p class="text-grey" style="font-size: 13px; margin-top: 12px; line-height: 1.6;">
                                                    ${(session.fieldData.info || session.fieldData['info-2']).substring(0, 150)}...
                                                </p>
                                            ` : ''}
                                        </div>
                                        <button class="heart" onclick="event.stopPropagation(); toggle('${session.id}')" style="background: none; border: none; font-size: 24px;">
                                            ‚ù§Ô∏è
                                        </button>
                                    </div>
                                </div>
                            `).join('')
                            : `
                            <div class="card">
                                <div style="text-align: center; padding: 40px 20px;">
                                    <div style="font-size: 64px; margin-bottom: 16px;">‚≠ê</div>
                                    <h3 style="font-size: 20px; margin-bottom: 12px; color: white;">No Saved Sessions</h3>
                                    <p class="text-grey" style="margin-bottom: 20px; font-weight: 500; line-height: 1.6;">
                                        Tap the ü§ç on any session in the schedule to save it to your personal agenda
                                    </p>
                                    <button class="btn btn-teal" onclick="show('schedule')" style="position: relative;">
                                        <span style="position: relative; z-index: 1;">BROWSE SCHEDULE ‚Üí</span>
                                    </button>
                                </div>
                            </div>
                        `}
                    </div>
                `;
            },
            
            map: () => {
                let currentFloor = 'ground';
                
                return `
                <div style="padding: 20px; background: rgba(7, 7, 7, 0.95); backdrop-filter: blur(20px); 
                     border-bottom: 1px solid rgba(0, 255, 153, 0.2); position: sticky; top: 0; z-index: 10;">
                    <h1 style="font-size: 32px; margin-bottom: 16px;">Venue Map</h1>
                    
                    <!-- Floor Selector -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 16px;">
                        <button class="floor-btn active" data-floor="ground" onclick="switchFloor('ground')" 
                                style="padding: 12px; background: linear-gradient(135deg, #00ff99, #00cc77); 
                                       border: none; border-radius: 12px; font-weight: 700; color: #070707; 
                                       font-family: 'Satoshi', sans-serif; font-size: 13px; cursor: pointer; transition: all 0.3s ease;">
                            Ground Floor
                        </button>
                        <button class="floor-btn" data-floor="first" onclick="switchFloor('first')"
                                style="padding: 12px; background: rgba(255, 255, 255, 0.1); 
                                       border: 1px solid rgba(0, 255, 153, 0.3); border-radius: 12px; font-weight: 700; 
                                       color: white; font-family: 'Satoshi', sans-serif; font-size: 13px; cursor: pointer; transition: all 0.3s ease;">
                            First Floor
                        </button>
                        <button class="floor-btn" data-floor="o2" onclick="switchFloor('o2')"
                                style="padding: 12px; background: rgba(255, 255, 255, 0.1); 
                                       border: 1px solid rgba(0, 255, 153, 0.3); border-radius: 12px; font-weight: 700; 
                                       color: white; font-family: 'Satoshi', sans-serif; font-size: 13px; cursor: pointer; transition: all 0.3s ease;">
                            The O2
                        </button>
                    </div>
                    
                    <input type="text" placeholder="üîç Find a brand or area..." id="venueSearch" 
                           onkeyup="searchVenue(this.value)" style="margin-bottom: 0;">
                </div>
                
                <div style="padding: 20px;" id="mapContent">
                    <!-- Ground Floor Map -->
                    <div id="floor-ground" class="floor-map">
                        <div style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.02) 100%);
                             backdrop-filter: blur(10px); border: 1px solid rgba(0, 255, 153, 0.2); border-radius: 8px;
                             padding: 0; margin: 12px 0; overflow: hidden; position: relative; touch-action: none;
                             box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);">
                            
                            <!-- Zoomable/Draggable Container -->
                            <div id="map-container-ground" class="map-container" style="transform-origin: center center; transition: transform 0.2s ease; user-select: none; -webkit-user-select: none;">
                                <!-- Real venue map as background -->
                                <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68fb46ee231d89aaea6b7063_DX25_Downstairs.webp" 
                                     alt="Ground Floor Map" 
                                     style="width: 100%; height: auto; display: block;">
                                
                                <!-- Transparent clickable overlay areas -->
                                <svg viewBox="0 0 1117 845" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
                                    <!-- Main Stage - clickable area -->
                                    <rect x="355" y="630" width="535" height="150" rx="8" fill="rgba(0,255,153,0.15)" stroke="rgba(0,255,153,0.3)" stroke-width="2" class="map-area-hover" data-area="main-stage" style="cursor: pointer; pointer-events: all;" onclick="navigateToSchedule('main-stage')"/>
                                    
                                    <!-- Floor A -->
                                    <path d="M 375 420 L 615 420 L 650 600 L 375 600 Z" fill="rgba(255,186,0,0.15)" stroke="rgba(255,186,0,0.3)" stroke-width="2" class="map-area-hover" data-area="floor-a" style="cursor: pointer;"/>
                                    
                                    <!-- Floor B -->
                                    <path d="M 630 420 L 850 420 L 850 600 L 665 600 Z" fill="rgba(255,186,0,0.15)" stroke="rgba(255,186,0,0.3)" stroke-width="2" class="map-area-hover" data-area="floor-b" style="cursor: pointer;"/>
                                    
                                    <!-- Industry Market - center area with tables -->
                                    <rect x="400" y="180" width="450" height="220" rx="12" fill="rgba(0,255,153,0.12)" stroke="rgba(0,255,153,0.25)" stroke-width="2" class="map-area-hover" data-area="industry-market" style="cursor: pointer; pointer-events: all;" onclick="navigateToIndustryMarket()"/>
                                    
                                    <!-- Main Bar (top) -->
                                    <rect x="415" y="30" width="285" height="95" rx="12" fill="rgba(26,75,255,0.15)" stroke="rgba(26,75,255,0.3)" stroke-width="2" class="map-area-hover" data-area="main-bar" style="cursor: pointer;"/>
                                    
                                    <!-- The Feedback Sessions (bottom left) -->
                                    <rect x="185" y="750" width="120" height="90" rx="8" fill="rgba(255,114,1,0.15)" stroke="rgba(255,114,1,0.3)" stroke-width="2" class="map-area-hover" data-area="feedback-sessions" style="cursor: pointer; pointer-events: all;" onclick="navigateToFeedbackSessions()"/>
                                </svg>
                            </div>
                            
                            <!-- Zoom Controls -->
                            <div style="position: absolute; bottom: 16px; right: 16px; display: flex; flex-direction: column; gap: 8px; z-index: 100;">
                                <button onclick="zoomMap('ground', 'in')" style="width: 44px; height: 44px; background: rgba(255, 255, 255, 0.85); 
                                        border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;
                                        font-size: 24px; font-weight: bold; color: #070707; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                                        transition: all 0.2s ease;">
                                    +
                                </button>
                                <button onclick="zoomMap('ground', 'out')" style="width: 44px; height: 44px; background: rgba(255, 255, 255, 0.85); 
                                        border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;
                                        font-size: 24px; font-weight: bold; color: #070707; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                                        transition: all 0.2s ease;">
                                    ‚àí
                                </button>
                            </div>
                        </div>
                        
                        <div class="card no-arrow" style="margin-top: 16px;">
                            <h3 style="font-size: 18px; margin-bottom: 12px; color: #00ff99;">üìç Ground Floor</h3>
                            <div style="display: grid; gap: 8px; font-size: 13px;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 20px; height: 20px; background: #00ff99; border-radius: 4px;"></div>
                                    <span class="text-grey" style="font-weight: 600;">Main Stage & Industry Market</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 20px; height: 20px; background: #ffba00; border-radius: 4px;"></div>
                                    <span class="text-grey" style="font-weight: 600;">Floor A & B Seating</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 20px; height: 20px; background: #1a4bff; border-radius: 4px;"></div>
                                    <span class="text-grey" style="font-weight: 600;">Main Bar & Entrance</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 20px; height: 20px; background: #1a1a1a; border: 1px solid #ff7201; border-radius: 4px;"></div>
                                    <span class="text-grey" style="font-weight: 600;">The Feedback Sessions (Exit via Marquee)</span>
                                </div>
                            </div>
                            <p class="text-grey" style="margin-top: 12px; font-size: 12px; line-height: 1.6;">
                                üí° <strong>Tip:</strong> Toilets, cloakroom, and stairs are located around the perimeter. Industry Market tables are in the center floor area.
                            </p>
                        </div>
                    </div>
                    
                    <!-- First Floor Map -->
                    <div id="floor-first" class="floor-map" style="display: none;">
                        <div style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.02) 100%);
                             backdrop-filter: blur(10px); border: 1px solid rgba(0, 255, 153, 0.2); border-radius: 8px;
                             padding: 0; margin: 12px 0; overflow: hidden; position: relative; touch-action: none;
                             box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);">
                            
                            <!-- Zoomable/Draggable Container -->
                            <div id="map-container-first" class="map-container" style="transform-origin: center center; transition: transform 0.2s ease; user-select: none; -webkit-user-select: none;">
                                <!-- Real venue map as background -->
                                <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68fb46ee6ccb844ca97ce83f_DX25_Upstairs.webp" 
                                     alt="First Floor Map" 
                                     style="width: 100%; height: auto; display: block;">
                            
                            <!-- Transparent clickable overlay areas -->
                            <svg viewBox="0 0 1117 790" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
                                <!-- Upstairs Bar (top center) -->
                                <rect x="270" y="15" width="615" height="110" rx="12" fill="rgba(26,75,255,0.15)" stroke="rgba(26,75,255,0.3)" stroke-width="2" class="map-area-hover" data-area="upstairs-bar" style="cursor: pointer; pointer-events: all;"/>
                                
                                <!-- Stage X Seating (top right orange blocks) -->
                                <rect x="665" y="30" width="345" height="120" rx="12" fill="rgba(255,186,0,0.15)" stroke="rgba(255,186,0,0.3)" stroke-width="2" class="map-area-hover" data-area="stage-x-top" style="cursor: pointer; pointer-events: all;" onclick="navigateToSchedule('stage-x-top')"/>
                                
                                <rect x="665" y="150" width="345" height="120" rx="12" fill="rgba(255,186,0,0.15)" stroke="rgba(255,186,0,0.3)" stroke-width="2" class="map-area-hover" data-area="stage-x-bottom" style="cursor: pointer; pointer-events: all;" onclick="navigateToSchedule('stage-x-bottom')"/>
                                
                                <!-- Bar/Networking Area (center) -->
                                <rect x="270" y="270" width="345" height="130" rx="12" fill="rgba(51,102,255,0.15)" stroke="rgba(51,102,255,0.3)" stroke-width="2" class="map-area-hover" data-area="bar-networking" style="cursor: pointer;"/>
                                
                                <!-- Kings Row Seating (curved center) -->
                                <ellipse cx="560" cy="465" rx="280" ry="50" fill="rgba(255,186,0,0.15)" stroke="rgba(255,186,0,0.3)" stroke-width="2" class="map-area-hover" data-area="kings-row" style="cursor: pointer;"/>
                                
                                <!-- Left seating area -->
                                <ellipse cx="395" cy="560" rx="140" ry="80" fill="rgba(255,186,0,0.15)" stroke="rgba(255,186,0,0.3)" stroke-width="2" class="map-area-hover" data-area="seating-left" style="cursor: pointer;"/>
                                
                                <!-- Right seating area -->
                                <ellipse cx="725" cy="560" rx="140" ry="80" fill="rgba(255,186,0,0.15)" stroke="rgba(255,186,0,0.3)" stroke-width="2" class="map-area-hover" data-area="seating-right" style="cursor: pointer;"/>
                                
                                <!-- Bottom seating -->
                                <rect x="410" y="670" width="300" height="70" rx="12" fill="rgba(255,186,0,0.15)" stroke="rgba(255,186,0,0.3)" stroke-width="2" class="map-area-hover" data-area="seating-bottom" style="cursor: pointer;"/>
                            </svg>
                            </div>
                            
                            <!-- Zoom Controls -->
                            <div style="position: absolute; bottom: 16px; right: 16px; display: flex; flex-direction: column; gap: 8px; z-index: 100;">
                                <button onclick="zoomMap('first', 'in')" style="width: 44px; height: 44px; background: rgba(255, 255, 255, 0.85); 
                                        border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;
                                        font-size: 24px; font-weight: bold; color: #070707; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                                        transition: all 0.2s ease;">
                                    +
                                </button>
                                <button onclick="zoomMap('first', 'out')" style="width: 44px; height: 44px; background: rgba(255, 255, 255, 0.85); 
                                        border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;
                                        font-size: 24px; font-weight: bold; color: #070707; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                                        transition: all 0.2s ease;">
                                    ‚àí
                                </button>
                            </div>
                        </div>
                        
                        <div class="card no-arrow" style="margin-top: 16px;">
                            <h3 style="font-size: 18px; margin-bottom: 12px; color: #00ff99;">üìç First Floor</h3>
                            <div style="display: grid; gap: 8px; font-size: 13px;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 20px; height: 20px; background: #1a4bff; border-radius: 4px;"></div>
                                    <span class="text-grey" style="font-weight: 600;">Upstairs Bar</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 20px; height: 20px; background: #00ff99; border-radius: 4px;"></div>
                                    <span class="text-grey" style="font-weight: 600;">Stage X (right side)</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 20px; height: 20px; background: #ffba00; border-radius: 4px;"></div>
                                    <span class="text-grey" style="font-weight: 600;">Seating Areas (Kings Row & Floor Seating)</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 20px; height: 20px; background: #3366ff; border-radius: 4px;"></div>
                                    <span class="text-grey" style="font-weight: 600;">Bar/Networking Area</span>
                                </div>
                            </div>
                            <p class="text-grey" style="margin-top: 12px; font-size: 12px; line-height: 1.6;">
                                üí° <strong>Tip:</strong> VIP Lobby & Stairs are on the right side. Accessible WC and balcony area are available on this floor.
                            </p>
                        </div>
                    </div>
                    
                    <!-- The O2 Map -->
                    <div id="floor-o2" class="floor-map" style="display: none;">
                        <div style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.02) 100%);
                             backdrop-filter: blur(10px); border: 1px solid rgba(0, 255, 153, 0.2); border-radius: 8px;
                             padding: 0; margin: 12px 0; overflow: hidden; position: relative; touch-action: none;
                             box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);">
                            
                            <!-- Zoomable/Draggable Container -->
                            <div id="map-container-o2" class="map-container" style="transform-origin: center center; transition: transform 0.2s ease; user-select: none; -webkit-user-select: none;">
                                <!-- Real O2 complex map as background -->
                                <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68fb46eecab9db824f0df777_DX25_Outside.webp" 
                                     alt="The O2 Complex Map" 
                                     style="width: 100%; height: auto; display: block;">
                            
                            <!-- Transparent clickable overlay areas -->
                            <svg viewBox="0 0 1117 1117" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
                                <!-- O2 Arena (top left circle) -->
                                <circle cx="200" cy="280" r="120" fill="rgba(26,26,26,0.15)" stroke="rgba(74,74,74,0.3)" stroke-width="3" class="map-area-hover" data-area="o2-arena" style="cursor: pointer; pointer-events: all;"/>
                                
                                <!-- Entrance A -->
                                <circle cx="435" cy="340" r="35" fill="rgba(26,75,255,0.15)" stroke="rgba(26,75,255,0.3)" stroke-width="2" class="map-area-hover" data-area="entrance-a" style="cursor: pointer;"/>
                                
                                <!-- Entrance B -->
                                <circle cx="530" cy="340" r="35" fill="rgba(26,75,255,0.15)" stroke="rgba(26,75,255,0.3)" stroke-width="2" class="map-area-hover" data-area="entrance-b" style="cursor: pointer;"/>
                                
                                <!-- Indigo at The O2 (L69) - large area right side -->
                                <ellipse cx="835" cy="750" rx="160" ry="180" fill="rgba(255,186,0,0.2)" stroke="rgba(255,149,0,0.4)" stroke-width="4" class="map-area-hover" data-area="indigo-o2" style="cursor: pointer;"/>
                                
                                <!-- Blue Room (L8) -->
                                <circle cx="485" cy="200" r="50" fill="rgba(51,102,255,0.2)" stroke="rgba(85,136,255,0.5)" stroke-width="3" class="map-area-hover" data-area="blue-room" style="cursor: pointer; pointer-events: all;" onclick="navigateToSchedule('blue-room')"/>
                                
                                <!-- Lower Level Shops area (green section) -->
                                <rect x="600" y="340" width="280" height="120" rx="12" fill="rgba(0,204,119,0.12)" stroke="rgba(0,255,153,0.25)" stroke-width="2" class="map-area-hover" data-area="shops" style="cursor: pointer;"/>
                            </svg>
                            </div>
                            
                            <!-- Zoom Controls -->
                            <div style="position: absolute; bottom: 16px; right: 16px; display: flex; flex-direction: column; gap: 8px; z-index: 100;">
                                <button onclick="zoomMap('o2', 'in')" style="width: 44px; height: 44px; background: rgba(255, 255, 255, 0.85); 
                                        border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;
                                        font-size: 24px; font-weight: bold; color: #070707; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                                        transition: all 0.2s ease;">
                                    +
                                </button>
                                <button onclick="zoomMap('o2', 'out')" style="width: 44px; height: 44px; background: rgba(255, 255, 255, 0.85); 
                                        border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;
                                        font-size: 24px; font-weight: bold; color: #070707; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                                        transition: all 0.2s ease;">
                                    ‚àí
                                </button>
                            </div>
                        </div>
                        
                        <div class="card" style="margin-top: 16px;">
                            <h3 style="font-size: 18px; margin-bottom: 12px; color: #00ff99;">üìç The O2 Complex</h3>
                            <div style="display: grid; gap: 8px; font-size: 13px;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 20px; height: 20px; background: #ffba00; border-radius: 4px;"></div>
                                    <span class="text-grey" style="font-weight: 600;"><strong>Indigo at The O2 (L69)</strong> - Your Event Venue</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 20px; height: 20px; background: #3366ff; border-radius: 4px;"></div>
                                    <span class="text-grey" style="font-weight: 600;">The Blue Room Stage (L8)</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 20px; height: 20px; background: #00cc77; border-radius: 4px;"></div>
                                    <span class="text-grey" style="font-weight: 600;">Lower Level - Shops & Restaurants</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 20px; height: 20px; background: #1a1a1a; border: 1px solid #4a4a4a; border-radius: 4px;"></div>
                                    <span class="text-grey" style="font-weight: 600;">O2 Arena (Separate Venue)</span>
                                </div>
                            </div>
                            
                            <div class="card" style="margin-top: 16px; background: rgba(255,186,0,0.1); border: 1px solid rgba(255,186,0,0.3);">
                                <h4 style="font-size: 16px; margin-bottom: 8px; color: #ffba00;">üéØ Getting to Indigo</h4>
                                <p class="text-grey" style="font-size: 13px; line-height: 1.6; margin: 0;">
                                    <strong>Main Entrance</strong> ‚Üí Follow signs to <strong>"Lower Level"</strong> ‚Üí Look for <strong>L69 Indigo</strong><br>
                                    The O2 complex includes multiple venues, restaurants, and shops. Allow extra time to find Indigo on your first visit.
                                </p>
                            </div>
                            
                            <p class="text-grey" style="margin-top: 12px; font-size: 12px; line-height: 1.6;">
                                üìç <strong>Nearby:</strong> Five Guys, Starbucks, O2 Shop, Gaucho, and more restaurants/shops on the lower level.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Industry Market Exhibitors -->
                    <div style="margin-top: 20px; background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.02) 100%); 
                         backdrop-filter: blur(10px); border: 1px solid rgba(0, 255, 153, 0.2); border-radius: 16px; 
                         padding: 20px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);" id="industry-market-section">
                        <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 16px;">
                            <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68fb492d4ba412d52124d3f7_Industry%20Market%20Logo%20(1).svg" 
                                 alt="Industry Market" 
                                 style="height: 56px; width: auto;">
                        </div>
                        <p class="text-grey" style="margin-bottom: 16px; font-weight: 500; font-size: 14px; text-align: center;">
                            Network and connect with leading music brands
                        </p>
                        <div id="brandsList">
                            ${webflowData.exhibitors && webflowData.exhibitors.length > 0 ? 
                                webflowData.exhibitors.map(exhibitor => {
                                    const url = exhibitor.fieldData?.link || exhibitor.fieldData?.url || exhibitor.fieldData?.website;
                                    const hasUrl = url && url !== '#';
                                    const tableNumber = exhibitor.fieldData?.['table-number'] || exhibitor.fieldData?.booth || '';
                                    const description = exhibitor.fieldData?.['short-bio'] || exhibitor.fieldData?.description || '';
                                    return `
                                    <${hasUrl ? `a href="${url}" target="_blank" rel="noopener noreferrer"` : 'div'} class="card brand-item" 
                                         style="border: 1px solid rgba(0, 255, 153, 0.3); cursor: ${hasUrl ? 'pointer' : 'default'}; text-decoration: none; display: block; margin-bottom: 12px;"
                                         data-name="${(exhibitor.fieldData?.name || '').toLowerCase()}"
                                         data-booth="${String(tableNumber || '').toLowerCase()}">
                                        ${getImageUrl(exhibitor, 'logo') || getImageUrl(exhibitor) ? `
                                            <img src="${getImageUrl(exhibitor, 'logo') || getImageUrl(exhibitor)}" 
                                                 class="sponsor-img" alt="${exhibitor.fieldData?.name || 'Exhibitor'}"
                                                 style="height: 100px; object-fit: contain; background: rgba(255,255,255,0.05); padding: 12px;">
                                        ` : ''}
                                        <div class="text-white" style="font-weight: 700; font-size: 16px; margin-bottom: 6px;">
                                            ${exhibitor.fieldData?.name || 'Brand'}
                                        </div>
                                        ${tableNumber ? `
                                            <div class="text-grey" style="font-size: 13px; font-weight: 600; margin-bottom: 6px;">
                                                üìç Table ${tableNumber}
                                            </div>
                                        ` : ''}
                                        ${description ? `
                                            <p class="text-grey" style="font-size: 12px; margin-top: 8px; line-height: 1.5;">
                                                ${description.substring(0, 120)}${description.length > 120 ? '...' : ''}
                                            </p>
                                        ` : ''}
                                    </${hasUrl ? 'a' : 'div'}>
                                `;
                                }).join('')
                                : `
                                ${createLoadingHTML('Loading exhibitors')}
                            `}
                        </div>
                    </div>
                </div>
            `;
            },
            
            extras: () => `
                <!-- Cash Competition -->
                <div id="cash-competition" style="background: linear-gradient(135deg, #ffba00, #ff7201); color: #070707; padding: 40px 24px; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: -50px; right: -50px; width: 200px; height: 200px; 
                         background: rgba(255, 255, 255, 0.2); border-radius: 50%; filter: blur(60px);"></div>
                    
                    <div style="text-align: center; position: relative; z-index: 1;">
                        <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/68ef7fb0baa5129a5c1c0666_instagram-icon.svg" 
                             alt="Instagram" 
                             style="width: 60px; height: 60px; margin-bottom: 20px;">
                        
                        <h2 style="font-size: 36px; font-weight: 800; margin-bottom: 8px; color: #070707 !important; font-family: 'Neusa', sans-serif; line-height: 1.2; background: none !important; -webkit-background-clip: initial !important; -webkit-text-fill-color: #070707 !important;">
                            Win ¬£250! üéâ
                        </h2>
                        <p style="font-size: 18px; margin-bottom: 24px; font-weight: 600; color: #070707;">
                            Share your favourite moments
                        </p>
                    </div>
                    
                    <div style="background: rgba(0,0,0,0.15); backdrop-filter: blur(10px); padding: 24px; 
                         border-radius: 16px; font-size: 14px; line-height: 1.8; position: relative; z-index: 1; color: #070707;">
                        <p style="margin-bottom: 14px; font-weight: 600;">
                            Tag us <strong style="font-weight: 800;">@dittomusic</strong> on your Stories for a chance to win ¬£250!
                        </p>
                        <p style="font-weight: 500;">
                            Don't forget to use our official social stickers. Just search <strong style="font-weight: 800;">"Ditto X"</strong> when posting.
                        </p>
                        <p style="font-weight: 600; margin-top:12px;">We‚Äôll be announcing the winner on the Main Stage at 4:30pm. You‚Äôll need to be there in person to claim the prize.</p>
                    </div>
                </div>
                
                <!-- Focusrite Competition -->
                <div id="focusrite" style="background: linear-gradient(135deg, #18181b, #22003a); padding: 24px; color: white;">
                    <div style="background: rgba(255,255,255,0.06); border: 1px solid rgba(126,0,233,0.35); border-radius: 16px; overflow: hidden; padding: 20px;">
                        <img src="/solo-studio-lead-2400-2400__13972.webp" alt="Focusrite Production Bundle" style="width: 100%; height: auto; display:block; max-height: 260px; object-fit: cover; border-radius: 12px; margin-bottom: 16px;">
                        <h2 style="font-size: 26px; margin-bottom: 8px; font-family: 'Neusa', sans-serif;">Win a Focusrite Production Bundle üé§</h2>
                        <p class="text-grey" style="margin-bottom: 12px;">
                            Create a free Ditto account and sign up for our emails below to enter. Bonus: you'll get the latest music industry advice and opportunities delivered straight to your inbox.
                        </p>
                        <p class="text-grey" style="margin-bottom: 16px;">
                            A winner will be chosen at random, alongside 3 runners-up who'll get a free Ditto Pro subscription each.
                        </p>
                        <iframe src="/Signup-form.html" title="Sign up" style="width: 100%; height: 620px; border: 0; background: transparent;"></iframe>
                    </div>
                </div>
                
                <div style="background: linear-gradient(135deg, #7e00e9, #070707); padding: 32px 24px; position: relative;">
                    <img src="https://cdn.prod.website-files.com/655e0fa544c67c1ee5ce01a4/664bbd76017aa6db7f1f4507_%27logo-2048-white.svg" 
                         alt="Ditto Music" 
                         style="width: 60px; height: auto; margin-bottom: 20px;">
                    <h2 style="font-size: 28px; margin-bottom: 10px; color: white !important; font-family: 'Neusa', sans-serif; background: none !important; -webkit-background-clip: initial !important; -webkit-text-fill-color: white !important;">30% off UNLIMITED Distribution</h2>
                    <p style="margin-bottom: 20px; font-weight: 500; color: rgba(255, 255, 255, 0.8);">
                        New to Ditto? Get started with an exclusive discount!
                    </p>
                    
                    <div style="background: rgba(0, 255, 153, 0.1); backdrop-filter: blur(10px); 
                         border: 2px solid rgba(0, 255, 153, 0.4); padding: 20px; border-radius: 20px; margin-bottom: 20px;">
                        <div style="margin-bottom: 12px; font-weight: 600; font-size: 13px; color: rgba(255, 255, 255, 0.7);">
                            Use code at checkout:
                        </div>
                        <div style="position: relative;">
                            <div class="promo-code" style="display: flex; align-items: center; justify-content: space-between; padding: 16px 20px;">
                                <span>DITTOX30</span>
                                <button onclick="copyPromoCode()" style="background: rgba(0,0,0,0.2); border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 6px; transition: all 0.3s ease;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="#070707" id="copyIcon">
                                        <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                                    </svg>
                                    <span id="copyText" style="font-size: 11px; font-weight: 700; color: #070707;">COPY</span>
                                </button>
                            </div>
                        </div>
                        <div style="font-size: 14px; line-height: 1.8; font-weight: 500; color: rgba(255, 255, 255, 0.9); margin-top: 16px;">
                            <div>‚úì Release unlimited music to 150+ stores</div>
                            <div>‚úì Keep 100% of your royalties</div>
                            <div>‚úì Industry-leading tools for artists</div>
                            <div>‚úì 30% off your first year</div>
                        </div>
                    </div>
                    
                    <button class="btn btn-teal" style="width: 100%; position: relative;">
                        <span style="position: relative; z-index: 1; font-size: 16px;">SIGN UP NOW ‚Üí</span>
                    </button>
                </div>
                
                <div style="padding: 24px;">
                    <h2 style="font-size: 24px; margin-bottom: 16px; color: white; font-family: 'Neusa', sans-serif;">Event Partners</h2>
                    <p class="text-grey" style="margin-bottom: 20px; font-weight: 500; font-size: 14px;">
                        Ditto X 2025 is made possible thanks to our amazing partners
                    </p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 14px;">
                        ${webflowData.sponsors.length > 0 ? 
                            webflowData.sponsors.slice(0, 6).map(sponsor => {
                                const url = sponsor.fieldData?.url || sponsor.fieldData?.website || sponsor.fieldData?.link || '#';
                                const hasUrl = url !== '#';
                                return `
                                    <${hasUrl ? `a href="${url}" target="_blank" rel="noopener noreferrer"` : 'div'} class="partner-card" style="text-decoration: none; ${hasUrl ? 'cursor: pointer;' : ''}">
                                        ${getImageUrl(sponsor, 'logo') || getImageUrl(sponsor) ? `
                                            <img src="${getImageUrl(sponsor, 'logo') || getImageUrl(sponsor)}" 
                                                 alt="${sponsor.fieldData?.name || 'Partner'}"
                                                 style="width: 80px; height: 80px; object-fit: contain; border-radius: 12px; 
                                                        background: rgba(255,255,255,0.05); padding: 8px;">
                                        ` : `
                                            <div class="partner-logo">${(sponsor.fieldData?.name || 'P').substring(0, 3).toUpperCase()}</div>
                                        `}
                                        <div class="text-grey" style="font-size: 11px; font-weight: 600; text-align: center; padding: 0 8px;">
                                            ${sponsor.fieldData?.name || 'Partner'}
                                        </div>
                                    </${hasUrl ? 'a' : 'div'}>
                                `;
                            }).join('')
                            : ['PRS','AMP','SJ','NHAM','PB'].map(p => `
                                <div class="partner-card">
                                    <div class="partner-logo">${p}</div>
                                    <div class="text-grey" style="font-size: 11px; font-weight: 600; text-align: center; padding: 0 8px;">
                                        ${p === 'PRS' ? 'PRS for Music' : p === 'AMP' ? 'Amplead' : p === 'SJ' ? 'SupaJam' : p === 'NHAM' ? 'NHAM' : 'Point Blank'}
                                    </div>
                                </div>
                            `).join('')}
                    </div>
                </div>
                
                <div style="padding: 24px; text-align: center;">
                    <div style="background: linear-gradient(135deg, #00ff99, #00cc77); -webkit-background-clip: text; 
                         -webkit-text-fill-color: transparent; font-size: 32px; font-weight: 900; margin-bottom: 8px;
                         letter-spacing: -1px; font-family: 'Neusa', sans-serif;">
                        #DittoX2025
                    </div>
                    <div class="text-grey" style="font-weight: 600;">Join the conversation</div>
                </div>
            `
        };
        
        function show(p) {
            const content = document.getElementById('content');
            content.style.opacity = '0';
            content.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                content.innerHTML = pages[p]();
                // Ensure the scroll position resets to top when switching pages
                content.scrollTop = 0;
                
                content.style.opacity = '1';
                content.style.transform = 'translateY(0)';
                content.style.transition = 'all 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
                
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                document.querySelector(`[data-page="${p}"]`).classList.add('active');
                updateBadge();
                
                if (p === 'welcome') {
                    startUpNextRefresh();
                }
                
                // Initialize map drag functionality after map page is rendered
                if (p === 'map') {
                    setTimeout(() => {
                        initMapDrag();
                    }, 300); // Delay to ensure DOM is fully updated
                }
            }, 150);
        }
        
        // Helper to show a page then scroll to an anchor inside it
        function showSection(p, anchorId) {
            show(p);
            setTimeout(() => {
                const content = document.getElementById('content');
                const el = document.getElementById(anchorId);
                if (el) {
                    el.scrollIntoView({ behavior: 'smooth', block: 'start' });
                } else if (content) {
                    content.scrollTop = 0;
                }
            }, 250);
        }
        
        function toggle(id) {
            fav.has(id) ? fav.delete(id) : fav.add(id);
            saveFavorites(); // Persist to localStorage
            const currentPage = document.querySelector('.nav-btn.active').getAttribute('data-page');
            show(currentPage);
        }
        
        function updateBadge() {
            const badge = document.getElementById('badge');
            if (fav.size > 0) {
                badge.textContent = fav.size;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }
        
        function startCountdown() {
            // Event starts: Thursday, November 20, 2025 at 10:00 AM
            const eventDate = new Date('2025-11-20T10:00:00').getTime();
            const countdownContainer = document.getElementById('countdownContainer');
            
            const update = () => {
                const now = new Date().getTime();
                const distance = eventDate - now;
                
                if (distance < 0) {
                    // Event has started - show welcome message
                    countdownContainer.innerHTML = `
                        <div class="welcome-message">
                            <h2 style="font-size: 28px; margin-bottom: 8px;">Welcome to Ditto X London 2025!</h2>
                            <p class="text-grey" style="font-weight: 600;">The event is now live üéâ</p>
                        </div>
                    `;
                    return;
                }
                
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                
                const daysEl = document.getElementById('days');
                const hoursEl = document.getElementById('hours');
                const minsEl = document.getElementById('mins');
                const secsEl = document.getElementById('secs');
                
                if (daysEl) daysEl.textContent = String(days).padStart(2, '0');
                if (hoursEl) hoursEl.textContent = String(hours).padStart(2, '0');
                if (minsEl) minsEl.textContent = String(minutes).padStart(2, '0');
                if (secsEl) secsEl.textContent = String(seconds).padStart(2, '0');
            };
            
            update();
            setInterval(update, 1000);
        }

        // Global interval for Up Next refresh
        let upNextInterval = null;

        function startUpNextRefresh() {
            // Clear any existing interval
            if (upNextInterval) {
                clearInterval(upNextInterval);
            }
            
            // Refresh Up Next section every 45 minutes (45 * 60 * 1000 ms)
            upNextInterval = setInterval(() => {
                console.log('üîÑ Refreshing Up Next sessions...');
                const currentPage = document.querySelector('.nav-btn.active')?.getAttribute('data-page');
                // Only refresh if still on welcome page
                if (currentPage === 'welcome') {
                    show('welcome');
                }
            }, 45 * 60 * 1000); // 45 minutes
            
            console.log('‚è∞ Up Next will refresh every 45 minutes');
        }

        function filterSchedule() {
            const items = document.querySelectorAll('.schedule-item');
            const searchInput = document.getElementById('searchInput');
            const stageFilter = document.getElementById('stageFilter');
            const typeFilter = document.getElementById('typeFilter');
            
            const searchTerm = searchInput ? searchInput.value.toLowerCase() : '';
            const selectedStage = stageFilter ? stageFilter.value : '';
            const selectedType = typeFilter ? typeFilter.value : '';
            
            items.forEach(item => {
                const name = item.getAttribute('data-name') || '';
                const stage = item.getAttribute('data-stage') || '';
                const type = item.getAttribute('data-type') || '';
                
                const matchesSearch = name.includes(searchTerm);
                const matchesStage = !selectedStage || stage === selectedStage;
                const matchesType = !selectedType || type === selectedType;
                
                if (matchesSearch && matchesStage && matchesType) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        function filterBrands(query) {
            const items = document.querySelectorAll('.brand-item');
            const searchTerm = query.toLowerCase();
            
            items.forEach(item => {
                const name = item.getAttribute('data-name');
                if (name.includes(searchTerm)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }
        
        // Switch between floor maps
        function switchFloor(floor) {
            // Hide all floor maps
            document.querySelectorAll('.floor-map').forEach(map => {
                map.style.display = 'none';
            });
            
            // Show selected floor
            const selectedFloor = document.getElementById(`floor-${floor}`);
            if (selectedFloor) {
                selectedFloor.style.display = 'block';
            }
            
            // Update button styles
            document.querySelectorAll('.floor-btn').forEach(btn => {
                if (btn.getAttribute('data-floor') === floor) {
                    btn.style.background = 'linear-gradient(135deg, #00ff99, #00cc77)';
                    btn.style.color = '#070707';
                    btn.style.border = 'none';
                    btn.classList.add('active');
                } else {
                    btn.style.background = 'rgba(255, 255, 255, 0.1)';
                    btn.style.color = 'white';
                    btn.style.border = '1px solid rgba(0, 255, 153, 0.3)';
                    btn.classList.remove('active');
                }
            });
            
            console.log(`üìç Switched to ${floor === 'ground' ? 'Ground Floor' : floor === 'first' ? 'First Floor' : 'The O2 Complex'}`);
        }
        
        // Navigate to schedule with stage filter
        function navigateToSchedule(stage) {
            console.log(`üéØ Navigating to schedule with stage: ${stage}`);
            
            // Switch to schedule page
            show('schedule');
            
            // Wait for page to load, then apply filter
            setTimeout(() => {
                const stageFilter = document.getElementById('stageFilter');
                if (stageFilter) {
                    // Map venue areas to schedule stage names
                    const stageMap = {
                        'main-stage': 'Main Stage',
                        'stage-x-top': 'Stage X',
                        'stage-x-bottom': 'Stage X',
                        'blue-room': 'The Blue Room'
                    };
                    
                    const stageName = stageMap[stage] || stage;
                    
                    // Log available options
                    console.log('Available stage options:', Array.from(stageFilter.options).map(opt => opt.value));
                    console.log('Attempting to set filter to:', stageName);
                    
                    stageFilter.value = stageName;
                    
                    // Trigger the filter
                    filterSchedule();
                    
                    console.log(`‚úÖ Filtered schedule to: ${stageName}`);
                } else {
                    console.error('‚ùå Stage filter not found');
                }
            }, 600); // Increased from 100ms to 600ms to wait for page render
        }
        
        // Navigate to Feedback Sessions schedule item
        function navigateToFeedbackSessions() {
            show('schedule');
            
            setTimeout(() => {
                // Try to find and scroll to feedback sessions item
                const scheduleItems = document.querySelectorAll('.schedule-item');
                let found = false;
                
                scheduleItems.forEach(item => {
                    const name = (item.getAttribute('data-name') || '').toLowerCase();
                    console.log('Checking schedule item:', name); // Debug logging
                    
                    if (name.includes('feedback')) {
                        found = true;
                        console.log('‚úÖ Found Feedback Sessions:', name);
                        
                        // Scroll to the item
                        item.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        
                        // Highlight briefly
                        item.style.background = 'rgba(0, 255, 153, 0.15)';
                        item.style.border = '2px solid rgba(0, 255, 153, 0.5)';
                        
                        setTimeout(() => {
                            item.style.background = '';
                            item.style.border = '';
                        }, 3000);
                    }
                });
                
                if (!found) {
                    console.warn('‚ùå Feedback Sessions schedule item not found');
                }
                
                console.log('üìù Navigated to Feedback Sessions');
            }, 600); // Increased from 100ms to 600ms
        }
        
        // Navigate to Industry Market exhibitors
        function navigateToIndustryMarket() {
            show('map');
            
            setTimeout(() => {
                // Scroll to industry market section if it exists
                const industrySection = document.getElementById('industry-market-section');
                if (industrySection) {
                    industrySection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
                
                console.log('üè¢ Navigated to Industry Market');
            }, 600); // Increased from 100ms to 600ms to wait for page transition
        }
        
        // Map zoom and drag functionality
        const mapStates = {
            ground: { scale: 1, x: 0, y: 0, isDragging: false, startX: 0, startY: 0 },
            first: { scale: 1, x: 0, y: 0, isDragging: false, startX: 0, startY: 0 },
            o2: { scale: 1, x: 0, y: 0, isDragging: false, startX: 0, startY: 0 }
        };
        
        // Zoom in/out function
        function zoomMap(floor, direction) {
            const state = mapStates[floor];
            const container = document.getElementById(`map-container-${floor}`);
            
            if (!container) return;
            
            // Adjust zoom level
            if (direction === 'in' && state.scale < 3) {
                state.scale += 0.5;
            } else if (direction === 'out' && state.scale > 1) {
                state.scale -= 0.5;
                
                // Reset position when zooming out to 1x
                if (state.scale === 1) {
                    state.x = 0;
                    state.y = 0;
                }
            }
            
            // Apply transform
            updateMapTransform(floor);
            
            console.log(`üîç ${floor} map: ${direction === 'in' ? 'Zoomed in' : 'Zoomed out'} to ${state.scale}x`);
        }
        
        // Update map transform
        function updateMapTransform(floor) {
            const state = mapStates[floor];
            const container = document.getElementById(`map-container-${floor}`);
            
            if (!container) return;
            
            // Apply scale and translate separately for proper behavior
            const translateX = state.x / state.scale;
            const translateY = state.y / state.scale;
            
            container.style.transform = `translate(${translateX}px, ${translateY}px) scale(${state.scale})`;
            container.style.cursor = state.scale > 1 ? 'grab' : 'default';
        }
        
        // Initialize drag functionality for all maps
        function initMapDrag() {
            console.log('üîß Initializing map drag functionality...');
            
            ['ground', 'first', 'o2'].forEach(floor => {
                const floorElement = document.getElementById(`floor-${floor}`);
                const wrapper = floorElement ? floorElement.querySelector('div[style*="background"]') : null;
                const container = document.getElementById(`map-container-${floor}`);
                
                console.log(`Checking ${floor}:`, {
                    floorElement: !!floorElement,
                    wrapper: !!wrapper,
                    container: !!container
                });
                
                if (!wrapper || !container) {
                    console.warn(`‚ùå Map drag: Could not find wrapper or container for ${floor}`);
                    return;
                }
                
                console.log(`‚úÖ Initialized drag for ${floor} floor`);
                
                // Mouse events - start on wrapper
                wrapper.addEventListener('mousedown', (e) => {
                    startDrag(e, floor);
                });
                
                // Touch events
                wrapper.addEventListener('touchstart', (e) => {
                    if (mapStates[floor].scale > 1) {
                        e.preventDefault();
                    }
                    startDrag(e.touches[0], floor, true);
                }, { passive: false });
                
                wrapper.addEventListener('touchmove', (e) => {
                    if (mapStates[floor].isDragging) {
                        e.preventDefault();
                        drag(e.touches[0], floor, true);
                    }
                }, { passive: false });
                
                wrapper.addEventListener('touchend', () => {
                    endDrag(floor);
                });
            });
            
            // Global mouse events for smoother dragging
            document.addEventListener('mousemove', (e) => {
                ['ground', 'first', 'o2'].forEach(floor => {
                    if (mapStates[floor].isDragging) {
                        drag(e, floor);
                    }
                });
            });
            
            document.addEventListener('mouseup', () => {
                ['ground', 'first', 'o2'].forEach(floor => {
                    if (mapStates[floor].isDragging) {
                        endDrag(floor);
                    }
                });
            });
        }
        
        function startDrag(e, floor, isTouch = false) {
            const state = mapStates[floor];
            
            // Only allow dragging when zoomed in
            if (state.scale <= 1) return;
            
            // Prevent text selection and other defaults (but only for mouse events)
            if (!isTouch && e.preventDefault) {
                e.preventDefault();
            }
            
            state.isDragging = true;
            state.startX = e.clientX - state.x;
            state.startY = e.clientY - state.y;
            
            // Change cursor to grabbing
            const container = document.getElementById(`map-container-${floor}`);
            if (container) {
                container.style.cursor = 'grabbing';
            }
        }
        
        function drag(e, floor, isTouch = false) {
            const state = mapStates[floor];
            
            if (!state.isDragging) return;
            
            if (!isTouch && e.preventDefault) {
                e.preventDefault();
            }
            
            state.x = e.clientX - state.startX;
            state.y = e.clientY - state.startY;
            
            updateMapTransform(floor);
        }
        
        function endDrag(floor) {
            const state = mapStates[floor];
            state.isDragging = false;
            
            // Reset cursor to grab (if still zoomed)
            const container = document.getElementById(`map-container-${floor}`);
            if (container && state.scale > 1) {
                container.style.cursor = 'grab';
            }
        }

        
        // Search venue (brands, booths, and areas)
        function searchVenue(query) {
            const items = document.querySelectorAll('.brand-item');
            const searchTerm = query.toLowerCase();
            
            items.forEach(item => {
                const name = item.getAttribute('data-name') || '';
                const booth = item.getAttribute('data-booth') || '';
                
                if (name.includes(searchTerm) || booth.includes(searchTerm)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
            
            // Highlight map areas if searching for specific terms
            const mapAreas = document.querySelectorAll('.map-area');
            if (searchTerm.length > 2) {
                mapAreas.forEach(area => {
                    const areaName = area.getAttribute('data-area') || '';
                    if (areaName.includes(searchTerm.replace(/ /g, '-'))) {
                        area.style.filter = 'brightness(1.5)';
                        area.style.transform = 'scale(1.05)';
                        area.style.transition = 'all 0.3s ease';
                    } else {
                        area.style.filter = 'brightness(1)';
                        area.style.transform = 'scale(1)';
                    }
                });
            } else {
                // Reset highlighting when search is cleared
                mapAreas.forEach(area => {
                    area.style.filter = 'brightness(1)';
                    area.style.transform = 'scale(1)';
                });
            }
        }
        
        // Copy promo code to clipboard
        function copyPromoCode() {
            const code = 'DITTOX30';
            
            // Copy to clipboard
            navigator.clipboard.writeText(code).then(() => {
                // Update button to show success
                const copyText = document.getElementById('copyText');
                const copyIcon = document.getElementById('copyIcon');
                
                if (copyText) copyText.textContent = 'COPIED!';
                if (copyIcon) {
                    copyIcon.innerHTML = '<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>';
                }
                
                // Reset after 2 seconds
                setTimeout(() => {
                    if (copyText) copyText.textContent = 'COPY';
                    if (copyIcon) {
                        copyIcon.innerHTML = '<path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>';
                    }
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy:', err);
                alert('Code: DITTOX30');
            });
        }
        
        // Initialize app
        async function init() {
            console.log('Loading Webflow data...');
            startLoadingMessages(); // Start rotating fun messages
            
            const success = await fetchWebflowData();
            
            stopLoadingMessages(); // Stop rotating messages
            
            if (!success) {
                document.getElementById('content').innerHTML = `
                    <div style="padding: 40px 20px;">
                        <div class="error">
                            <div style="font-size: 48px; margin-bottom: 16px; text-align: center;">‚ö†Ô∏è</div>
                            <div style="text-align: center;">
                                <strong>Unable to connect to proxy server</strong><br>
                                <small style="opacity: 0.8; display: block; margin-top: 8px;">
                                    Make sure the proxy server is running:<br><br>
                                    <code style="background: rgba(0,0,0,0.3); padding: 4px 8px; border-radius: 4px; display: inline-block; margin-top: 4px;">
                                        npm install && npm start
                                    </code>
                                </small>
                            </div>
                        </div>
                        <button class="btn btn-teal" style="width: 100%; margin-top: 20px;" onclick="init()">
                            <span style="position: relative; z-index: 1;">RETRY CONNECTION</span>
                        </button>
                    </div>
                `;
                return;
            }
            
            console.log('Data loaded successfully!');
            loadFavorites(); // Load saved agenda from previous visits
            show('welcome');
        }
        
        // PWA & Service Worker Management
        let deferredPrompt = null;
        let isOnline = navigator.onLine;
        
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('‚úÖ Service Worker registered:', registration.scope);
                        
                        // Check for updates every hour
                        setInterval(() => {
                            registration.update();
                        }, 60 * 60 * 1000);
                        
                        // Listen for waiting service worker
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    showPWAStatus('üì¶ Update available! Refresh to get the latest version.', 'updating', 5000);
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.error('‚ùå Service Worker registration failed:', error);
                    });
            });
        }
        
        // Handle install prompt
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Don't show if already dismissed or installed
            const dismissed = localStorage.getItem('install-prompt-dismissed');
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
            
            if (!dismissed && !isStandalone) {
                // Show after 30 seconds
                setTimeout(() => {
                    showInstallPrompt();
                }, 30000);
            }
        });
        
        // Accept install
        function acceptInstall() {
            if (!deferredPrompt) return;
            
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === 'accepted') {
                    console.log('‚úÖ User accepted install');
                    showPWAStatus('‚úÖ Installing Ditto X 25 app...', 'success', 3000);
                }
                deferredPrompt = null;
                hideInstallPrompt();
            });
        }
        
        // Dismiss install
        function dismissInstall() {
            localStorage.setItem('install-prompt-dismissed', 'true');
            hideInstallPrompt();
        }
        
        // Show install prompt
        function showInstallPrompt() {
            const prompt = document.getElementById('installPrompt');
            if (prompt) {
                prompt.classList.add('show');
            }
        }
        
        // Hide install prompt
        function hideInstallPrompt() {
            const prompt = document.getElementById('installPrompt');
            if (prompt) {
                prompt.classList.remove('show');
            }
        }
        
        // Detect when app is installed
        window.addEventListener('appinstalled', () => {
            console.log('‚úÖ Ditto X 25 installed!');
            showPWAStatus('üéâ Ditto X 25 installed! Now works offline.', 'success', 3000);
            hideInstallPrompt();
        });
        
        // Online/Offline detection
        window.addEventListener('online', () => {
            isOnline = true;
            showPWAStatus('üåê Back online - syncing data...', 'success', 2000);
            // Refresh data when back online
            setTimeout(() => {
                fetchWebflowData();
            }, 1000);
        });
        
        window.addEventListener('offline', () => {
            isOnline = false;
            showPWAStatus('üì∂ Offline Mode - Using cached data', 'offline', 5000);
        });
        
        // Check if currently offline
        if (!isOnline) {
            setTimeout(() => {
                showPWAStatus('üì∂ Offline Mode - Using cached data', 'offline', 5000);
            }, 2000);
        }
        
        // Show PWA status message
        function showPWAStatus(message, type = '', duration = 3000) {
            const status = document.getElementById('pwaStatus');
            if (!status) return;
            
            status.textContent = message;
            status.className = 'pwa-status show ' + type;
            
            setTimeout(() => {
                status.classList.remove('show');
            }, duration);
        }
        
        // Check if running as installed app
        function isInstalledPWA() {
            return window.matchMedia('(display-mode: standalone)').matches || 
                   window.navigator.standalone === true;
        }
        
        // Show offline indicator on page load if offline
        if (!navigator.onLine) {
            document.addEventListener('DOMContentLoaded', () => {
                showPWAStatus('üì∂ Offline Mode', 'offline', 0); // 0 = stays visible
            });
        }
        
        init();
    </script>
</body>
</html>